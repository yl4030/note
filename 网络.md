# Internet

## DNS

DNS是一台服务器，这台服务器提供了回答客户主机名和ip对应关系的功能

### 1.本地解析

```shell
[root@node01 ~]# vim /etc/hosts
127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4
::1         localhost localhost.localdomain localhost6 localhost6.localdomain6
192.168.37.112 www.baidu.com 

[root@node01 ~]# ping www.baidu.com
PING www.baidu.com (192.168.37.112) 56(84) bytes of data.
64 bytes from www.baidu.com (192.168.37.112): icmp_seq=1 ttl=64 time=0.460 ms
64 bytes from www.baidu.com (192.168.37.112): icmp_seq=2 ttl=64 time=0.346 ms
64 bytes from www.baidu.com (192.168.37.112): icmp_seq=3 ttl=64 time=0.380 ms
64 bytes from www.baidu.com (192.168.37.112): icmp_seq=4 ttl=64 time=0.336 ms
^C
--- www.baidu.com ping statistics ---
4 packets transmitted, 4 received, 0% packet loss, time 3001ms
rtt min/avg/max/mdev = 0.336/0.380/0.460/0.052 ms
```

### 2.DNS解析

resolv.conf的关键字主要有4个，分别为：

- nameserver：定义DNS服务器的IP地址。可以有很多行的nameserver，每一个带一个IP地址。在查询时就按nameserver在本文件中的顺序进行，且只有当第一个nameserver没有反应时才查询下面的nameserver。
- domain：定义本地域名
- search：定义域名的搜索列表
- sortlist：对返回的域名进行排序
  注意：这里最主要的就是nameserver关键字，如果没有指定nameserver就找不到DNS服务，其它关键字是可选的。

```bash
[root@node01 ~]# vim /etc/resolv.conf
# Generated by NetworkManager
domain  51osos.com
search  www.51osos.com  51osos.com
nameserver 10.100.1.10        #在这里添加nameserver（从第一行开始解析）
nameserver 114.114.114.114
```

### 3.优先级

默认的是本地解析文件优先级高，通过配置文件/etc/nsswitch.conf来改变优先级

```shell
[root@node01 ~]# vim /etc/nsswitch.conf
#hosts:     db files nisplus nis dns 
hosts:      dns files myhostname #files代表本地解析文件，dns代表dns服务器，哪个在前面哪个优先

[root@node01 ~]# ping www.baidu.com
PING www.a.shifen.com (14.215.177.38) 56(84) bytes of data.
64 bytes from 14.215.177.38 (14.215.177.38): icmp_seq=1 ttl=128 time=15.0 ms #与本地解析ip不同
64 bytes from 14.215.177.38 (14.215.177.38): icmp_seq=2 ttl=128 time=16.1 ms
64 bytes from 14.215.177.38 (14.215.177.38): icmp_seq=3 ttl=128 time=14.8 ms
64 bytes from 14.215.177.38 (14.215.177.38): icmp_seq=4 ttl=128 time=45.3 ms
^C
--- www.a.shifen.com ping statistics ---
4 packets transmitted, 4 received, 0% packet loss, time 3005ms
rtt min/avg/max/mdev = 14.812/22.840/45.333/12.996 ms
```

